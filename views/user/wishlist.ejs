
<!DOCTYPE html>
<html>
  <%- include('../partials/head.ejs') %>
  <body>
    <div id="all">
      <div id="content">
        <div class="container">
          <div class="row">
            <div class="col-lg-12">
              
            </div>
            <div id="basket" class="col-lg-12 mt-5">
              <div class="box">
                <form method="post" action="checkout1.html">
                  <h1>Wishlist</h1>
                  <!-- <p class="text-muted">You currently have 3 item(s) in your cart.</p> -->
                  <div class="mt-3">
                    <h3>Welcome : <span id="userName"></span></h3>
                  </div>
                  <div class="table-responsive">
                    <table class="table">
                      <thead>
                        <tr>
                          <th colspan="">Image</th>
                          <th colspan="">Product</th>
                          <!-- <th>Quantity</th> -->
                          <th>price</th>
                          <!-- <th>Discount</th> -->
                          <!-- <th colspan="">Total</th> -->
                        </tr>
                      </thead>
                      <tbody id="wishlists">
                        <!-- <tr>
                          <td><a href=""><img src="img/detailsquare.jpg" alt="White Blouse Armani"></a></td>
                          <td><a href="">White Blouse Armani</a></td>
                          <td>$123.00</td>
                          <td>$0.00</td>
                          <td>$246.00</td>
                          <td><a href=""><i class="fa fa-trash-o"></i></a></td>
                        </tr> -->
                        
                      </tbody>
                      
                    </table>
                  </div>
                  
                </form>
              </div>
              
            </div>
          </div>
        </div>
      </div>
    </div>
    <script>
      getWislist()
      function getWislist() {
        let temp =''
        fetch("/product/getWishlist") 
        .then(data=>data.json())
        .then(data=>{
          data.items.forEach((element,index) => {
           temp +=`
                  <tr>
                    <td><a href="/product/view/${element.wishlistItems[0]._id}"><img src="/images/${element.wishlistItems[0]._id}.jpg" alt="White Blouse Armani"></a></td>
                    <td><a href="/product/view/${element.wishlistItems[0]._id}">${element.wishlistItems[0].name}</a></td>
                    <td>${element.wishlistItems[0].price}</td>
                    <td><a class="text-danger" onclick="remove('${element.wishlistItems[0]._id}')"><i class="fa fa-trash"></i></a></td>
                  </tr>
                        `
 
          });
          document.getElementById("wishlists").innerHTML =temp
          document.getElementById("userName").innerHTML = data.userName
        })
      }

      function remove(productId) {
       fetch("/product/removeWishlist",{
        method: 'PUT',
        headers:{
	        'Content-Type':'application/json'
	      },
        body:JSON.stringify({productId})
       }) .then(data => data.json())
       .then(data =>{
        getWislist()
         alert('product removed successfully')
       } )
      }
    </script>
  </body>
</html>